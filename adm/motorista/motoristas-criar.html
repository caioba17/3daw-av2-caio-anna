<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Cadastrar Motorista</title>
    <link rel="stylesheet" href="../../css/onibus-criar.css">
</head>
<body>

    <div class="painel-container">
        <div class="painel-header">
            <h2>Novo Motorista</h2>
            <a href="motoristas-listar.html" class="btn-cancelar">Cancelar</a>
        </div>

        <form onsubmit="event.preventDefault(); salvarMotorista();">
            
            <label for="nome">Nome Completo</label>
            <input type="text" id="nome" placeholder="Ex: João da Silva" required>

            <label for="matricula">Matrícula (CNH ou ID)</label>
            <input type="text" id="matricula" placeholder="Ex: MOT-2024" required>

            <button type="submit" class="btn-salvar">Salvar Cadastro</button>
        </form>
        
        <p id="msg"></p>
    </div>

    <script>
    function salvarMotorista() {
        let nome = document.getElementById("nome").value;
        let matricula = document.getElementById("matricula").value;
        let msg = document.getElementById("msg");

        msg.innerHTML = "Salvando...";

        let xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                if(this.responseText.includes("sucesso")) {
                    msg.innerHTML = "Motorista cadastrado!";
                    msg.style.color = "green";
                    setTimeout(() => { window.location.href = "motoristas-listar.html"; }, 1000);
                } else {
                    msg.innerHTML = "Erro: " + this.responseText;
                    msg.style.color = "red";
                }
            }
        };
        
        xhttp.open("POST", "motoristas-criar.php", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xhttp.send(`nome=${nome}&matricula=${matricula}`);
    }
    </script>
</body>
</html>